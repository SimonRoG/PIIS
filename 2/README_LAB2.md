# ЛАБОРАТОРНА РОБОТА 2

## Програмування на мові штучного інтелекту LISP

**Виконав:** Семен Прохода ІП-з31

**Варіант 13:** Реалізувати на мові Lisp БЗ "ВІЛ-інфекція" на основі Prolog програми

---

## Зміст

1. [Завдання](#завдання)
2. [Двійкове дерево рішень](#двійкове-дерево-рішень)
3. [Реалізація на Lisp](#реалізація-на-lisp)
4. [Структура коду](#структура-коду)
5. [Приклади використання](#приклади-використання)
6. [Результати тестування](#результати-тестування)
7. [Порівняння з Prolog](#порівняння-з-prolog)
8. [Висновки](#висновки)

---

## Завдання

На основі лабораторної роботи 1 (Prolog програма для діагностики ВІЛ-інфекції) необхідно:

1. **Побудувати двійкове дерево рішень**, яке відображає логіку діагностики
2. **Реалізувати систему на мові Lisp**, яка функціонально еквівалентна Prolog програмі
3. **Створити документацію** з поясненнями та прикладами використання

---

## Двійкове дерево рішень

Двійкове дерево рішень для діагностики ВІЛ-інфекції представлено в файлі [`decision_tree.md`](./decision_tree.md).

### Основні характеристики дерева

- **Чотири рівні ймовірності**: дуже висока, висока, середня, низька
- **Ключові критерії**:
  - Кількість симптомів (>= 15, >= 10, >= 6, < 6)
  - Наявність специфічних комбінацій симптомів
  - Результати аналізів
- **Захворювання-індикатори**:
  - Мононуклеоз (ангіна + запалення лімфовузлів)
  - Серозний менінгіт (нудота + блювання)
  - Енцефаліт (нудота + блювання)
  - Езофагіт (біль за грудиною + порушення ковтання)

### Алгоритм дерева рішень

```
1. Підрахувати загальну кількість симптомів
2. Перевірити на дуже високу ймовірність:
   - Якщо симптомів >= 15 → ДУЖЕ ВИСОКА
   - Якщо є всі 5 захворювань + аналізи → ДУЖЕ ВИСОКА
3. Перевірити на високу ймовірність:
   - Якщо 10 <= симптомів < 15 → ВИСОКА
   - Якщо є мононуклеоз з аналізами АБО інше захворювання → ВИСОКА
4. Перевірити на середню ймовірність:
   - Якщо 6 <= симптомів < 10 → СЕРЕДНЯ
   - Якщо є специфічна комбінація 6 симптомів → СЕРЕДНЯ
5. Інакше → НИЗЬКА
```

---

## Реалізація на Lisp

### Файли проекту

- **`hiv.lisp`** - основний файл з реалізацією системи діагностики
- **`decision_tree.md`** - опис двійкового дерева рішень
- **`README_LAB2.md`** - документація (цей файл)

### Особливості реалізації

1. **Функціональна парадигма**: використання функцій вищого порядку, списків та рекурсії
2. **Структури даних**: використання `defstruct` для представлення пацієнтів
3. **База знань**: параметри для зберігання симптомів та їх відповідності захворюванням
4. **Модульність**: логічний поділ на секції (база знань, діагностика, інтерфейс)

---

## Структура коду

### 1. Визначення симптомів та аналізів

```lisp
(defparameter *all-symptoms*
  '(pidvyshchena-temperatura    ; підвищена температура
    angina                       ; ангіна
    zapalennya-limfovuzliv      ; запалення лімфовузлів
    ...))

(defparameter *all-analyses*
  '(pidvyshchenyy-riven-leykocytiv      ; підвищений рівень лейкоцитів
    pidvyshchenyy-riven-limfocytiv      ; підвищений рівень лімфоцитів
    atypovi-mononuklearni-klityny))     ; атипові мононуклеарні клітини
```

### 2. База знань про захворювання

```lisp
(defparameter *mononucleosis-symptoms*
  '(pidvyshchena-temperatura angina zapalennya-limfovuzliv ...))

(defparameter *meningitis-symptoms*
  '(golovnyy-bil nudota blyuvannya pidvyshchena-temperatura))

(defparameter *encephalitis-symptoms*
  '(golovnyy-bil nudota blyuvannya pidvyshchena-temperatura))

(defparameter *esophagitis-symptoms*
  '(bil-za-grudynoyu porushennya-kovtannya))
```

### 3. Структура пацієнта

```lisp
(defstruct patient
  (name nil)      ; ім'я пацієнта
  (symptoms nil)  ; список симптомів
  (analyses nil)) ; список аналізів
```

### 4. Діагностичні функції

```lisp
;; Перевірка наявності захворювань
(defun has-mononucleosis-symptoms-p (patient) ...)
(defun has-meningitis-symptoms-p (patient) ...)
(defun has-encephalitis-symptoms-p (patient) ...)
(defun has-esophagitis-symptoms-p (patient) ...)

;; Визначення ймовірності ВІЛ
(defun has-very-high-hiv-probability-p (patient) ...)
(defun has-high-hiv-probability-p (patient) ...)
(defun has-medium-hiv-probability-p (patient) ...)
(defun has-low-hiv-probability-p (patient) ...)

;; Головна функція діагностики
(defun diagnose-hiv-probability (patient)
  (cond ((has-very-high-hiv-probability-p patient) 'дуже-висока)
        ((has-high-hiv-probability-p patient) 'висока)
        ((has-medium-hiv-probability-p patient) 'середня)
        (t 'низька)))
```

### 5. Інтерфейс користувача

```lisp
;; Виведення діагнозу
(defun print-diagnosis (patient) ...)

;; Інтерактивна діагностика
(defun interactive-diagnosis () ...)

;; Демонстрація роботи
(defun run-demo () ...)
```

---

## Приклади використання

### Запуск у Common Lisp

```lisp
;; Завантаження програми
(load "hiv.lisp")

;; Запуск демонстрації з тестовими пацієнтами
(run-demo)

;; Інтерактивна діагностика
(interactive-diagnosis)

;; Діагностика конкретного пацієнта
(print-diagnosis (get-patient "людина1"))

;; Перевірка, на що вказує симптом
(what-disease-does-symptom-suggest 'angina)
```

### Створення власного пацієнта

```lisp
;; Додати нового пацієнта
(add-patient "пацієнт1"
             '(pidvyshchena-temperatura angina zapalennya-limfovuzliv)
             '(pidvyshchenyy-riven-leykocytiv))

;; Отримати діагноз
(print-diagnosis (get-patient "пацієнт1"))
```

### Програмний доступ до діагностики

```lisp
;; Створити пацієнта
(defparameter *my-patient*
  (make-patient :name "тест"
                :symptoms '(angina zapalennya-limfovuzliv nudota blyuvannya)
                :analyses '(pidvyshchenyy-riven-leykocytiv)))

;; Отримати ймовірність
(diagnose-hiv-probability *my-patient*)  ; => висока

;; Перевірити наявність захворювань
(has-mononucleosis-symptoms-p *my-patient*)  ; => T
(has-meningitis-symptoms-p *my-patient*)     ; => T
```

---

## Результати тестування

### Тестовий пацієнт 1 (з Prolog програми)

**Дані:**
```
Ім'я: людина1
Симптоми: підвищена температура, ангіна, запалення лімфовузлів, 
          понос, нудота, блювання, біль за грудиною, головний біль, розбитість
Аналізи: підвищений рівень лейкоцитів
```

**Виконання програми:**
```
>>> ТЕСТОВИЙ ПАЦІЄНТ 1 (з Prolog програми) <<<

=== Інформація про пацієнта: людина1 ===
Симптоми (9): PIDVYSHCHENA-TEMPERATURA, ANGINA, ZAPALENNYA-LIMFOVUZLIV, 
              PONOS, NUDOTA, BLYUVANNYA, BIL-ZA-GRUDYNOYU, GOLOVNYY-BIL, 
              ROZBYTIST
Аналізи: PIDVYSHCHENYY-RIVEN-LEYKOCYTIV

--- Діагностика ---
Мононуклеоз (симптоми): ТАК
Мононуклеоз (аналізи): ТАК
Серозний менінгіт: ТАК
Енцефаліт: ТАК
Езофагіт: НІ

>>> ЙМОВІРНІСТЬ ВІЛ-ІНФЕКЦІЇ: ВИСОКА <<<
```

**Порівняння з Prolog:**
- Prolog результат: `має_вірогідність_віл(людина1, X). X = висока`
- Lisp результат: `ВИСОКА`
- ✅ **Результати ідентичні**

### Тестовий пацієнт 2 (дуже висока ймовірність)

**Дані:**
```
Ім'я: людина2
Симптоми: всі 19 симптомів
Аналізи: підвищений рівень лейкоцитів, атипові мононуклеарні клітини
```

**Результат:**
```
>>> ТЕСТОВИЙ ПАЦІЄНТ 2 (дуже висока ймовірність) <<<

=== Інформація про пацієнта: людина2 ===
Симптоми (19): [всі симптоми]
Аналізи: PIDVYSHCHENYY-RIVEN-LEYKOCYTIV, ATYPOVI-MONONUKLEARNI-KLITYNY

--- Діагностика ---
Мононуклеоз (симптоми): ТАК
Мононуклеоз (аналізи): ТАК
Серозний менінгіт: ТАК
Енцефаліт: ТАК
Езофагіт: ТАК

>>> ЙМОВІРНІСТЬ ВІЛ-ІНФЕКЦІЇ: ДУЖЕ-ВИСОКА <<<
```

**Аналіз:**
- Кількість симптомів: 19 >= 15 ✅
- Всі захворювання присутні ✅
- Результат: **ДУЖЕ ВИСОКА ЙМОВІРНІСТЬ** ✅

### Тестовий пацієнт 3 (низька ймовірність)

**Дані:**
```
Ім'я: людина3
Симптоми: підвищена температура, ангіна, слабкість, головний біль
Аналізи: немає
```

**Результат:**
```
>>> ТЕСТОВИЙ ПАЦІЄНТ 3 (низька ймовірність) <<<

=== Інформація про пацієнта: людина3 ===
Симптоми (4): PIDVYSHCHENA-TEMPERATURA, ANGINA, SLABKIST, GOLOVNYY-BIL
Аналізи: 

--- Діагностика ---
Мононуклеоз (симптоми): НІ
Мононуклеоз (аналізи): НІ
Серозний менінгіт: НІ
Енцефаліт: НІ
Езофагіт: НІ

>>> ЙМОВІРНІСТЬ ВІЛ-ІНФЕКЦІЇ: НИЗЬКА <<<
```

**Аналіз:**
- Кількість симптомів: 4 < 6 ✅
- Є всі базові симптоми ✅
- Результат: **НИЗЬКА ЙМОВІРНІСТЬ** ✅

### Перевірка граничних випадків

| Кількість симптомів | Очікуваний результат | Фактичний результат | Статус |
|---------------------|---------------------|---------------------|--------|
| 19 (всі)            | Дуже висока         | Дуже висока         | ✅     |
| 15                  | Дуже висока         | Дуже висока         | ✅     |
| 14                  | Висока              | Висока              | ✅     |
| 10                  | Висока              | Висока              | ✅     |
| 9                   | Середня             | Середня             | ✅     |
| 6                   | Середня             | Середня             | ✅     |
| 5                   | Низька              | Низька              | ✅     |
| 4                   | Низька              | Низька              | ✅     |

---

## Порівняння з Prolog

### Спільні риси

1. **Логіка діагностики**: повністю відтворена з Prolog
2. **База знань**: ті самі симптоми та захворювання
3. **Правила висновку**: ідентичні умови для визначення ймовірності
4. **Результати**: повна відповідність для всіх тестових випадків

### Відмінності у реалізації

| Аспект | Prolog | Lisp |
|--------|--------|------|
| Парадигма | Логічне програмування | Функціональне програмування |
| Механізм виводу | Зворотній ланцюг міркувань | Пряма оцінка функцій |
| Представлення знань | Факти і правила | Списки та структури |
| Запити | `має_вірогідність_віл(Людина, X)` | `(diagnose-hiv-probability patient)` |
| Обробка даних | Унікація та backtracking | Рекурсія та обробка списків |

### Переваги Lisp реалізації

1. **Типізація даних**: використання `defstruct` для чіткої структури пацієнта
2. **Модульність**: чіткий поділ на функції з конкретними завданнями
3. **Інтерфейс**: зручні функції виведення та інтерактивного введення
4. **Тестування**: вбудовані тестові пацієнти та демонстрація
5. **Розширюваність**: легко додавати нові функції та аналізи

### Переваги Prolog реалізації

1. **Декларативність**: опис правил більш природний
2. **Гнучкість запитів**: можна запитувати у різних напрямках
3. **Автоматичний вивід**: не потрібно явно визначати порядок перевірок
4. **Компактність**: менше коду для тих самих правил

---

## Висновки

### Досягнуті результати

1. ✅ **Побудовано двійкове дерево рішень** для діагностики ВІЛ-інфекції
   - Відображає всю логіку з Prolog програми
   - Має чотири рівні ймовірності
   - Використовує ієрархічний підхід до діагностики

2. ✅ **Реалізовано систему на Lisp**, яка:
   - Функціонально еквівалентна Prolog програмі
   - Має зручний інтерфейс користувача
   - Підтримує інтерактивний режим
   - Містить тестові приклади

3. ✅ **Створено детальну документацію** з:
   - Описом структури коду
   - Прикладами використання
   - Результатами тестування
   - Порівнянням з Prolog

### Технічні досягнення

1. **Повна функціональна відповідність**: всі тести показали ідентичні результати з Prolog
2. **Якісний код**: структурований, з коментарями, легко читається
3. **Розширюваність**: легко додавати нові симптоми, захворювання та правила
4. **Практичність**: система готова до використання та тестування

### Навички, отримані під час виконання

1. **Функціональне програмування** на Common Lisp
2. **Представлення знань** у функціональній парадигмі
3. **Конвертація** між логічною та функціональною парадигмами
4. **Проектування** експертних систем
5. **Побудова** дерев рішень для діагностичних систем

### Можливі покращення

1. **Фактори довіри**: додати ймовірнісні оцінки для кожного симптому
2. **Пояснення**: система пояснення прийнятих рішень
3. **Історія**: зберігання історії діагностики пацієнтів
4. **Графічний інтерфейс**: веб-інтерфейс або GUI для зручності
5. **Машинне навчання**: навчання системи на реальних даних
6. **Інтеграція з базами даних**: зберігання великої кількості пацієнтів

### Практична цінність

Розроблена система демонструє:
- Можливість створення експертних систем на Lisp
- Еквівалентність представлення знань у різних парадигмах
- Практичне застосування дерев рішень у медичній діагностиці
- Важливість структурованого підходу до розробки ШІ-систем

---

## Довідкова інформація

### Використані технології

- **Мова програмування**: Common Lisp
- **Парадигма**: Функціональне програмування
- **Структури даних**: Списки, структури (defstruct)
- **Методи**: Рекурсія, обробка списків, умовні вирази

### Файли проекту

```
2/
├── hiv.lisp            # Основна реалізація системи
├── decision_tree.md    # Опис двійкового дерева рішень
└── README_LAB2.md      # Документація (цей файл)
```

### Запуск програми

```bash
# У командному рядку Common Lisp
sbcl --load hiv.lisp

# Або в REPL
(load "hiv.lisp")
(run-demo)
```

### Контакти

- **Автор**: Семен Прохода
- **Група**: ІП-з31
- **Дата**: 2024

---

**Лабораторна робота виконана повністю згідно з вимогами.**
